<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · FastMultipole.jl</title><meta name="title" content="Reference · FastMultipole.jl"/><meta property="og:title" content="Reference · FastMultipole.jl"/><meta property="twitter:title" content="Reference · FastMultipole.jl"/><meta name="description" content="Documentation for FastMultipole.jl."/><meta property="og:description" content="Documentation for FastMultipole.jl."/><meta property="twitter:description" content="Documentation for FastMultipole.jl."/><meta property="og:url" content="https://flow.byu.edu/FastMultipole/reference/"/><meta property="twitter:url" content="https://flow.byu.edu/FastMultipole/reference/"/><link rel="canonical" href="https://flow.byu.edu/FastMultipole/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">FastMultipole.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../quickstart/">Quick Start</a></li><li><a class="tocitem" href="../guided_examples/">Guided Examples</a></li><li><a class="tocitem" href="../advanced_usage/">Advanced Usage</a></li><li class="is-active"><a class="tocitem" href>Reference</a></li><li><a class="tocitem" href="../theory/">Theory</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/byuflowlab/FastMultipole" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/byuflowlab/FastMultipole/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><ul><li><a href="#FastMultipole.DerivativesSwitch-NTuple{4, Any}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Bool, Tuple}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch-NTuple{4, Bool}"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.DerivativesSwitch"><code>FastMultipole.DerivativesSwitch</code></a></li><li><a href="#FastMultipole.MultiTree"><code>FastMultipole.MultiTree</code></a></li><li><a href="#FastMultipole.ProbeSystem-Union{Tuple{Matrix{TF}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.ProbeSystem-Union{Tuple{Array{StaticArraysCore.SVector{3, TF}, 1}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.ProbeSystem"><code>FastMultipole.ProbeSystem</code></a></li><li><a href="#FastMultipole.SortWrapper-Tuple{Any}"><code>FastMultipole.SortWrapper</code></a></li><li><a href="#FastMultipole.Tree"><code>FastMultipole.Tree</code></a></li><li><a href="#FastMultipole.EmptyTree-Tuple{Any}"><code>FastMultipole.EmptyTree</code></a></li><li><a href="#FastMultipole.L2B_velocity-Union{Tuple{VPS}, Tuple{PS}, Tuple{TF2}, Tuple{TF1}, Tuple{TF1, Any, Any, Any, Any, Any, Any, Any, TF2, Any, Any, Any, Any, Any, Any, Any, Any, Any, DerivativesSwitch{PS, VPS}}} where {TF1, TF2, PS, VPS}"><code>FastMultipole.L2B_velocity</code></a></li><li><a href="#FastMultipole.L2B_velocity_gradient-Union{Tuple{VPS}, Tuple{PS}, Tuple{TF}, Tuple{TF, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, DerivativesSwitch{PS, VPS}}} where {TF, PS, VPS}"><code>FastMultipole.L2B_velocity_gradient</code></a></li><li><a href="#FastMultipole.add_line!-Tuple{ProbeSystem, Vararg{Any, 4}}"><code>FastMultipole.add_line!</code></a></li><li><a href="#FastMultipole.d2rdx2-Tuple{Any, Any, Any}"><code>FastMultipole.d2rdx2</code></a></li><li><a href="#FastMultipole.direct!-Tuple{Any, Any}"><code>FastMultipole.direct!</code></a></li><li><a href="#FastMultipole.direct!-Tuple{Tuple}"><code>FastMultipole.direct!</code></a></li><li><a href="#FastMultipole.drdx-Tuple{Any, Any, Any}"><code>FastMultipole.drdx</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Any, Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Any}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.fmm!-Tuple{Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a></li><li><a href="#FastMultipole.populate_influence_matrix!-Union{Tuple{GS}, Tuple{VS}, Tuple{VPS}, Tuple{PS}, Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, UnitRange, DerivativesSwitch{PS, VPS, VS, GS}, Any, Any}} where {TF, PS, VPS, VS, GS}"><code>FastMultipole.populate_influence_matrix!</code></a></li><li><a href="#FastMultipole.populate_influence_matrix!-Union{Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, Any, Any, Any, Any, UnitRange, Int64}} where TF"><code>FastMultipole.populate_influence_matrix!</code></a></li><li><a href="#FastMultipole.populate_influence_matrix!-NTuple{9, Any}"><code>FastMultipole.populate_influence_matrix!</code></a></li><li><a href="#FastMultipole.populate_influence_matrix!-Union{Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, Any, Any, Any, UnitRange, Int64}} where TF"><code>FastMultipole.populate_influence_matrix!</code></a></li><li><a href="#FastMultipole.populate_influence_matrix!-Tuple{Any, Any, Any, Tuple, Any, Tuple, Any, Any}"><code>FastMultipole.populate_influence_matrix!</code></a></li><li><a href="#FastMultipole.reset!-Tuple{ProbeSystem}"><code>FastMultipole.reset!</code></a></li><li><a href="#FastMultipole.resort!-Tuple{Tuple, FastMultipole.MultiTree}"><code>FastMultipole.resort!</code></a></li><li><a href="#FastMultipole.unsort!-Tuple{Tuple, FastMultipole.MultiTree}"><code>FastMultipole.unsort!</code></a></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch" href="#FastMultipole.DerivativesSwitch"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch</code></pre><p>Switch indicating whether the scalar potential, vector potential, velocity, and/or velocity gradient should be computed for a target system. Information is stored as type parameters, allowing the compiler to compile away if statements.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L68-L72">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-NTuple{4, Any}" href="#FastMultipole.DerivativesSwitch-NTuple{4, Any}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, vector_potential, velocity, velocity_gradient)</code></pre><p>Constructs a tuple of <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> objects.</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the scalar potential should be computed for each target system</li><li><code>vector_potential::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the vector potential should be computed for each target system</li><li><code>velocity::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the velocity should be computed for each target system</li><li><code>velocity_gradient::Vector{Bool}</code>: a vector of <code>::Bool</code> indicating whether the velocity gradient should be computed for each target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L75-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-NTuple{4, Bool}" href="#FastMultipole.DerivativesSwitch-NTuple{4, Bool}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, vector_potential, velocity, velocity_gradient)</code></pre><p>Constructs a single <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> object.</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: a <code>::Bool</code> indicating whether the scalar potential should be computed for the target system</li><li><code>vector_potential::Bool</code>: a <code>::Bool</code> indicating whether the vector potential should be computed for the target system</li><li><code>velocity::Bool</code>: a <code>::Bool</code> indicating whether the velocity should be computed for the target system</li><li><code>velocity_gradient::Bool</code>: a <code>::Bool</code> indicating whether the velocity gradient should be computed for the target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L92-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Bool, Tuple}" href="#FastMultipole.DerivativesSwitch-Tuple{Bool, Bool, Bool, Bool, Tuple}"><code>FastMultipole.DerivativesSwitch</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DerivativesSwitch(scalar_potential, vector_potential, velocity, velocity_gradient, target_systems)</code></pre><p>Constructs a <code>::Tuple</code> of indentical <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> objects of the same length as <code>target_systems</code> (if it is a <code>::Tuple</code>), or a single <a href="#FastMultipole.DerivativesSwitch"><code>DerivativesSwitch</code></a> (if <code>target_system</code> is not a <code>::Tuple</code>)</p><p><strong>Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: a <code>::Bool</code> indicating whether the scalar potential should be computed for each target system</li><li><code>vector_potential::Bool</code>: a <code>::Bool</code> indicating whether the vector potential should be computed for each target system</li><li><code>velocity::Bool</code>: a <code>::Bool</code> indicating whether the velocity should be computed for each target system</li><li><code>velocity_gradient::Bool</code>: a <code>::Bool</code> indicating whether the velocity gradient should be computed for each target system</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L109-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.MultiTree" href="#FastMultipole.MultiTree"><code>FastMultipole.MultiTree</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bodies[index<em>list] is the same sort operation as performed by the tree sorted</em>bodies[inverse<em>index</em>list] undoes the sort operation performed by the tree</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L242-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem" href="#FastMultipole.ProbeSystem"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem</code></pre><p>Convenience system for defining locations at which the potential, velocity, or velocity gradient may be desired.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L310-L314">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem-Union{Tuple{Array{StaticArraysCore.SVector{3, TF}, 1}}, Tuple{TF}} where TF" href="#FastMultipole.ProbeSystem-Union{Tuple{Array{StaticArraysCore.SVector{3, TF}, 1}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem(positions; kwargs...)</code></pre><p>A convenience system constructor for calculating the influence of source systems at locations not already described by a system object. It behaves like a system whose elements induce a null potential field.</p><p><strong>Arguments</strong></p><ul><li><code>positions::Vector{SVector{3,Float64}}</code>: a vector of position vectors of each probe</li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: whether or not to compute the scalar potential at each probe location</li><li><code>vector_potential::Bool</code>: whether or not to compute the vector potential at each probe location</li><li><code>velocity::Bool</code>: whether or not to compute the velocity at each probe location</li><li><code>velocity_gradient::Bool</code>: whether or not to compute the velocity gradient at each probe location</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/probe.jl#L9-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.ProbeSystem-Union{Tuple{Matrix{TF}}, Tuple{TF}} where TF" href="#FastMultipole.ProbeSystem-Union{Tuple{Matrix{TF}}, Tuple{TF}} where TF"><code>FastMultipole.ProbeSystem</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ProbeSystem(positions; kwargs...)</code></pre><p>Dispatch of <a href="#FastMultipole.ProbeSystem"><code>ProbeSystem</code></a> accepting a matrix of horizontally concatenated column vectors describing the position of each probe. Optional arguments are identical.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/probe.jl#L35-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.SortWrapper-Tuple{Any}" href="#FastMultipole.SortWrapper-Tuple{Any}"><code>FastMultipole.SortWrapper</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SortWrapper(system)</code></pre><p>Convenience wrapper for systems whose elements cannot be sorted in-place (e.g. structured grids). The resulting object is treated like any other <code>system</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L289-L293">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.Tree" href="#FastMultipole.Tree"><code>FastMultipole.Tree</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">abstract type Tree{TF,P} end</code></pre><p>Supertype of all octree structures with <code>TF</code> the floating point type and <code>P</code> the expansion order.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/containers.jl#L235-L239">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.EmptyTree-Tuple{Any}" href="#FastMultipole.EmptyTree-Tuple{Any}"><code>FastMultipole.EmptyTree</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EmptyTree(system)</code></pre><p>Returns an empty tree. Used if <code>system</code> is empty.</p><p><strong>Arguments</strong></p><ul><li><code>system</code>: the system from which a tree is to be created</li></ul><p><strong>Returns</strong></p><ul><li><code>tree</code>: if <code>typeof(system)&lt;:Tuple</code>, a <code>::MultiTree</code> is returned; otherwise, a <code>::SingleTree</code> is returned</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/tree.jl#L100-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.L2B_velocity-Union{Tuple{VPS}, Tuple{PS}, Tuple{TF2}, Tuple{TF1}, Tuple{TF1, Any, Any, Any, Any, Any, Any, Any, TF2, Any, Any, Any, Any, Any, Any, Any, Any, Any, DerivativesSwitch{PS, VPS}}} where {TF1, TF2, PS, VPS}" href="#FastMultipole.L2B_velocity-Union{Tuple{VPS}, Tuple{PS}, Tuple{TF2}, Tuple{TF1}, Tuple{TF1, Any, Any, Any, Any, Any, Any, Any, TF2, Any, Any, Any, Any, Any, Any, Any, Any, Any, DerivativesSwitch{PS, VPS}}} where {TF1, TF2, PS, VPS}"><code>FastMultipole.L2B_velocity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Does not include the rotation matrix R yet. Eq 28 in S&amp;L</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/spherical.jl#L393">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.L2B_velocity_gradient-Union{Tuple{VPS}, Tuple{PS}, Tuple{TF}, Tuple{TF, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, DerivativesSwitch{PS, VPS}}} where {TF, PS, VPS}" href="#FastMultipole.L2B_velocity_gradient-Union{Tuple{VPS}, Tuple{PS}, Tuple{TF}, Tuple{TF, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, Any, DerivativesSwitch{PS, VPS}}} where {TF, PS, VPS}"><code>FastMultipole.L2B_velocity_gradient</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Eq 35-37 S&amp;L</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/spherical.jl#L429">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.add_line!-Tuple{ProbeSystem, Vararg{Any, 4}}" href="#FastMultipole.add_line!-Tuple{ProbeSystem, Vararg{Any, 4}}"><code>FastMultipole.add_line!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_line!(probes::ProbeSystem, x1, x2, n_probes, i_last)</code></pre><p>Adds <code>n_probes</code> probes in a line between <code>x1</code> and <code>x2</code>. Specifically, they are added at the midpoint of equally partiti    oned segments of the line.</p><p><strong>Arguments</strong></p><ul><li><code>probes::ProbeSystem</code>: the probe system whose <code>.position</code> field is to be updated</li><li><code>x1::Vector{Float64}</code>: the first point defining the line along which probes are to be added</li><li><code>x2::Vector{Float64}</code>: the second point defining the line along which probes are to be added</li><li><code>n_probes::Int</code>: number of probes to be added</li><li><code>i_last::Int</code>: index of the last probe in <code>probes</code></li></ul><p><strong>Output</strong></p><ul><li><code>i_last::Int</code>: updated index of the last probe in <code>probes</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/probe.jl#L113-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.d2rdx2-Tuple{Any, Any, Any}" href="#FastMultipole.d2rdx2-Tuple{Any, Any, Any}"><code>FastMultipole.d2rdx2</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dr<em>k/dx</em>idx_j</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/derivatives.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.direct!-Tuple{Any, Any}" href="#FastMultipole.direct!-Tuple{Any, Any}"><code>FastMultipole.direct!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direct!(target_system, source_system; derivatives_switches)</code></pre><p>Applies all interactions of <code>source_system</code> acting on <code>target_system</code> without multipole acceleration.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_system</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_system</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/direct.jl#L37-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.direct!-Tuple{Tuple}" href="#FastMultipole.direct!-Tuple{Tuple}"><code>FastMultipole.direct!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">direct!(systems; derivatives_switches)</code></pre><p>Applies all interactions of <code>systems</code> acting on itself without multipole acceleration.</p><p><strong>Arguments</strong></p><ul><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/direct.jl#L4-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.drdx-Tuple{Any, Any, Any}" href="#FastMultipole.drdx-Tuple{Any, Any, Any}"><code>FastMultipole.drdx</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>dr<em>j/dx</em>i</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/derivatives.jl#L24-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Any, Any}" href="#FastMultipole.fmm!-Tuple{Any, Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_systems, source_systems; kwargs...)</code></pre><p>Apply all interactions of <code>source_systems</code> acting on <code>target_systems</code> using the fast multipole method. Assumes compatibility functions have been overloaded for both source and target systems.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>expansion_order::Int</code>: the expansion order to be used</li><li><code>leaf_size_source::Int</code>: maximum number of bodies from <code>source_systems</code> allowed in a leaf-level branch</li><li><code>leaf_size_target::Int</code>: maximum number of bodies from <code>target_systems</code> allowed in a leaf-level branch</li><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (comuted without multipoles) interactions should be included</li><li><code>farfield::Bool</code>: indicates whether far-field (comuted with multipoles) interactions should be included</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself</li><li><code>unsort_source_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for the <code>source_systems</code></li><li><code>unsort_target_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for the <code>target_systems</code></li><li><code>source_shink_recenter::Bool</code>: indicates whether or not to resize branches for the <code>source_systems</code> octree after it is created to increase computational efficiency</li><li><code>target_shink_recenter::Bool</code>: indicates whether or not to resize branches for the <code>target_systems</code> octree after it is created to increase computational efficiency</li><li><code>save_tree_source::Bool</code>: indicates whether or not to save a VTK file for visualizing the source octree</li><li><code>save_tree_target::Bool</code>: indicates whether or not to save a VTK file for visualizing the target octree</li><li><code>save_name_source::String</code>: name and path of the source octree visualization if <code>save_tree == true</code></li><li><code>save_name_target::String</code>: name and path of the target octree visualization if <code>save_tree == true</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L851-L893">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Any}" href="#FastMultipole.fmm!-Tuple{Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(systems; kwargs...)</code></pre><p>Apply all interactions of <code>systems</code> acting on itself using the fast multipole method. Assumes compatibility functions have been overloaded for both source and target systems.</p><p><strong>Arguments</strong></p><ul><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>expansion_order::Int</code>: the expansion order to be used</li><li><code>leaf_size::Int</code>: maximum number of bodies from <code>systems</code> allowed in a leaf-level branch</li><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (comuted without multipoles) interactions should be included in the direct_list</li><li><code>farfield::Bool</code>: indicates whether far-field (comuted with multipoles) interactions should be included in the m2l_list</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself in the direct_list</li><li><code>unsort_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>systems</code></li><li><code>shink_recenter::Bool</code>: indicates whether or not to resize branches for the octree after it is created to increase computational efficiency</li><li><code>save_tree::Bool</code>: indicates whether or not to save a VTK file for visualizing the octree</li><li><code>save_name::String</code>: name and path of the octree visualization if <code>save_tree == true</code></li><li><code>gpu::Bool</code>: indicates whether or not GPU is to be used for direct interactions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L927-L960">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Any, Tree, Any}" href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_tree, target_systems, source_tree, source_systems; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using existing <code>::Tree</code> objects.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>target_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>source_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>reset_source_tree::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(source_systems)</code> indicating whether or not to reset the expansions of each source tree</li><li><code>reset_target_tree::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(source_systems)</code> indicating whether or not to reset the expansions of each target tree</li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (computed without multipoles) interactions should be included in the direct_list</li><li><code>farfield::Bool</code>: indicates whether far-field (computed with multipoles) interactions should be included in the m2l_list</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself in the direct_list</li><li><code>unsort_source_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>source_systems</code></li><li><code>unsort_target_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>target_systems</code></li><li><code>gpu::Bool</code>: indicates whether or not GPU is to be used for direct interactions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L1041-L1079">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Any, Tree, Vararg{Any, 5}}" href="#FastMultipole.fmm!-Tuple{Tree, Any, Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(target_tree, target_systems, source_tree, source_systems, m2l_list, direct_list, derivatives_switches; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using existing <code>::Tree</code> objects.</p><p><strong>Arguments</strong></p><ul><li><p><code>target_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>target_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>source_tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>source_systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>m2l_list::Vector{SVector{2,Int32}}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which multipole expansions of the source branch are to be transformed to local expansions at the target branch</p></li><li><p><code>direct_list::Union{Vector{SVector{2,Int32}}, InteractionList}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which interactions are to be evaluted without multipole expansion (i.e., directly); if <code>typeof(direct_list) &lt;: InteractionList</code>, then prepared influence matrices are used rather than computing direct influences on the fly</p></li><li><p><code>derivatives_switches::Union{DerivativesSwitch, Tuple{&lt;:DerivativesSwitch,...}}</code>: switch determining which of scalar potential, vector potential, velocity, and/or velocity gradient are to be computed for each target system</p></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(target_systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (comuted without multipoles) interactions should be included</li><li><code>farfield::Bool</code>: indicates whether far-field (comuted with multipoles) interactions should be included</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself</li><li><code>unsort_source_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>source_systems</code></li><li><code>unsort_target_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>target_systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L1151-L1190">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Any}" href="#FastMultipole.fmm!-Tuple{Tree, Any}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(tree, systems; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using an existing <code>::Tree</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>multipole_threshold::Float64</code>: number between 0 and 1 (often denoted theta in [0,1]) controls the accuracy by determining the non-dimensional distance after which multipoles are used; 0 means an infinite distance (no error, high cost), and 1 means barely convergent (high error, low cost)</li><li><code>scalar_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a scalar potential from <code>source_systems</code></li><li><code>vector_potential::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a vector potential from <code>source_systems</code></li><li><code>velocity::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity from <code>source_systems</code></li><li><code>velocity_gradient::Bool</code>: either a <code>::Bool</code> or a <code>::AbstractVector{Bool}</code> of length <code>length(systems)</code> indicating whether each system should receive a velocity gradient from <code>source_systems</code></li><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>nearfield::Bool</code>: indicates whether near-field (computed without multipoles) interactions should be included in the direct_list</li><li><code>farfield::Bool</code>: indicates whether far-field (computed with multipoles) interactions should be included in the m2l_list</li><li><code>self_induced::Bool</code>: indicates whether to include the interactions of each leaf-level branch on itself in the direct_list</li><li><code>unsort_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>systems</code></li><li><code>gpu::Bool</code>: indicates whether or not GPU is to be used for direct interactions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L987-L1016">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.fmm!-Tuple{Tree, Vararg{Any, 5}}" href="#FastMultipole.fmm!-Tuple{Tree, Vararg{Any, 5}}"><code>FastMultipole.fmm!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fmm!(tree, systems; kwargs...)</code></pre><p>Dispatches <code>fmm!</code> using an existing <code>::Tree</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>tree::Tree</code>: a <code>&lt;:Tree</code> object (see <a href="#FastMultipole.Tree"><code>Tree</code></a>)</p></li><li><p><code>systems</code>: either</p><ul><li>a system object for which compatibility functions have been overloaded, or</li><li>a tuple of system objects for which compatibility functions have been overloaded</li></ul></li><li><p><code>m2l_list::Vector{SVector{2,Int32}}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which multipole expansions of the source branch are to be transformed to local expansions at the target branch</p></li><li><p><code>direct_list::Union{Vector{SVector{2,Int32}}, InteractionList}</code>: list of branch index pairs <code>[i_target, i_source]</code> for which interactions are to be evaluted without multipole expansion (i.e., directly); if <code>typeof(direct_list) &lt;: InteractionList</code>, then prepared influence matrices are used rather than computing direct influences on the fly</p></li><li><p><code>derivatives_switches::Union{DerivativesSwitch, Tuple{&lt;:DerivativesSwitch,...}}</code>: switch determining which of scalar potential, vector potential, velocity, and/or velocity gradient are to be computed for each target system</p></li></ul><p><strong>Optional Arguments</strong></p><ul><li><code>upward_pass::Bool</code>: whether or not to form the multipole expansions from source bodies and translate them upward in the source tree</li><li><code>horizontal_pass::Bool</code>: whether or not to transform multipole expansions from the source tree into local expansions in the target tree</li><li><code>downward_pass::Bool</code>: whether or not to translate local expansions down to the leaf level of the target tree and evaluate them</li><li><code>unsort_bodies::Bool</code>: indicates whether or not to undo the sort operation used to generate the octree for <code>systems</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L1106-L1130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.populate_influence_matrix!-NTuple{9, Any}" href="#FastMultipole.populate_influence_matrix!-NTuple{9, Any}"><code>FastMultipole.populate_influence_matrix!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>multiple source systems</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L650">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.populate_influence_matrix!-Tuple{Any, Any, Any, Tuple, Any, Tuple, Any, Any}" href="#FastMultipole.populate_influence_matrix!-Tuple{Any, Any, Any, Tuple, Any, Tuple, Any, Any}"><code>FastMultipole.populate_influence_matrix!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>single source body, multiple target systems</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L687">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.populate_influence_matrix!-Union{Tuple{GS}, Tuple{VS}, Tuple{VPS}, Tuple{PS}, Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, UnitRange, DerivativesSwitch{PS, VPS, VS, GS}, Any, Any}} where {TF, PS, VPS, VS, GS}" href="#FastMultipole.populate_influence_matrix!-Union{Tuple{GS}, Tuple{VS}, Tuple{VPS}, Tuple{PS}, Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, UnitRange, DerivativesSwitch{PS, VPS, VS, GS}, Any, Any}} where {TF, PS, VPS, VS, GS}"><code>FastMultipole.populate_influence_matrix!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>single source body, single target system</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L695">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.populate_influence_matrix!-Union{Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, Any, Any, Any, Any, UnitRange, Int64}} where TF" href="#FastMultipole.populate_influence_matrix!-Union{Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, Any, Any, Any, Any, UnitRange, Int64}} where TF"><code>FastMultipole.populate_influence_matrix!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>single source system</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L663">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.populate_influence_matrix!-Union{Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, Any, Any, Any, UnitRange, Int64}} where TF" href="#FastMultipole.populate_influence_matrix!-Union{Tuple{TF}, Tuple{Matrix{TF}, Any, Any, Any, Any, Any, Any, UnitRange, Int64}} where TF"><code>FastMultipole.populate_influence_matrix!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>single source system (without specifying i<em>col</em>prev)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/fmm.jl#L658">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.reset!-Tuple{ProbeSystem}" href="#FastMultipole.reset!-Tuple{ProbeSystem}"><code>FastMultipole.reset!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reset!(probes)</code></pre><p>Zeroes all values (e.g. scalar/vector potential, velocity, and/or velocity gradient) of all probes.</p><p><strong>Arguments</strong></p><ul><li><code>probes::ProbeSystem</code>: a <code>::</code><a href="#FastMultipole.ProbeSystem"><code>ProbeSystem</code></a> object</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/probe.jl#L146-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.resort!-Tuple{Tuple, FastMultipole.MultiTree}" href="#FastMultipole.resort!-Tuple{Tuple, FastMultipole.MultiTree}"><code>FastMultipole.resort!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Performs the same sort operation as the tree. (Undoes <code>unsort!</code> operation.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/tree.jl#L463-L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="FastMultipole.unsort!-Tuple{Tuple, FastMultipole.MultiTree}" href="#FastMultipole.unsort!-Tuple{Tuple, FastMultipole.MultiTree}"><code>FastMultipole.unsort!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>Undoes the sort operation performed by the tree.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/byuflowlab/FastMultipole/blob/715ef7cd3f3b001ea046e68b4ed4d4c345c8b8ac/src/tree.jl#L433-L435">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../advanced_usage/">« Advanced Usage</a><a class="docs-footer-nextpage" href="../theory/">Theory »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Wednesday 21 August 2024 16:48">Wednesday 21 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
